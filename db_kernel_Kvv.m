function val = db_kernel_Kvv(x, xi, qp, eps1p, eps2p, c1p, c2p, c3p, c4p) % (83)

q = qp;
eps1 = eps1p;
eps2 = eps2p;
c1 = c1p;
c2 = c2p;
c3 = c3p;
c4 = c4p;

val = -1/(eps1 + eps2)*exp((c1/eps1 + c4/eps2)*(eps1*x - eps2*xi)/(eps1 + eps2)).* ...  % zweites eps1 zu eps2 ausgebessert
    (c2/q*besseli(0, 2*sqrt(c2*c3)/(eps1 + eps2)*sqrt((x - xi).*(eps1/eps2*x + xi))) ...
    + sqrt(c2*c3*(eps1/eps2*x + xi)./(x - xi)) ...
    .*besseli(1, 2*sqrt(c2*c3)/(eps1 + eps2)*sqrt((x - xi).*(eps1/eps2*x + xi))) ...
    + (c3*q^2*eps1 - c2*eps2)/(q*eps2) ...
    *P(q*eps1*c3/eps2*(x - xi)/(eps1 + eps2), c2/(q*eps1)*(eps1*x + eps2*xi)/(eps1 + eps2)));
if isnan(val(1))
    val(1) =  -1/(eps1 + eps2) ...
    *(c2/q ...
    + (c3*q^2*eps1 - c2*eps2)/(q*eps2));
end
if isnan(val(end))
    val(end) =  -1/(eps1 + eps2) ...
    *(c2/q ...
    + c2*c3*x(end)/eps2 ...
    + (c3*q^2*eps1 - c2*eps2)/(q*eps2));
end
